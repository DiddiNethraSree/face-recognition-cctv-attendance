{% extends "base.html" %}

{% block content %}
<div class="app-container">
    <div class="main-content">
        <div class="dashboard-header">
            <div>
                <h1 style="font-size: 2rem; font-weight: 800; color: var(--text-main);">Hello, {{ student_id }} ğŸ‘‹</h1>
                <p style="color: var(--text-muted);">Your Personal Attendance Report</p>
            </div>
        </div>

        <div class="stats-grid fade-in">
            <div class="stat-card">
                <div class="stat-label">Current Attendance</div>
                <div class="stat-value" style="color: {% if percent > 75 %}var(--success){% elif percent >= 65 %}var(--warning){% else %}var(--danger){% endif %};">
                    {{ percent }}%
                </div>
                <div class="progress-container">
                    <div class="progress-bar {% if percent > 75 %}bg-success{% elif percent >= 65 %}bg-warning{% else %}bg-danger{% endif %}" style="width: {{ percent }}%;"></div>
                </div>
            </div>
            
            <div class="stat-card">
                <div class="stat-label">Classes Attended</div>
                <div class="stat-value">
                    {% set present_count = 0 %}
                    {% for d, p in records %}
                        {% if p %}{% set present_count = present_count + 1 %}{% endif %}
                    {% endfor %}
                    {{ records|selectattr("1")|list|length }} / {{ records|length }}
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-label">Eligibility Status</div>
                <div class="stat-value" style="font-size: 1.5rem;">
                    {% if percent > 75 %}
                        <span class="status-badge status-success" style="font-size: 1rem; padding: 0.5rem 1rem;">âœ… Eligible</span>
                    {% elif percent >= 65 %}
                        <span class="status-badge status-warning" style="font-size: 1rem; padding: 0.5rem 1rem;">âš ï¸ Condonation</span>
                    {% else %}
                        <span class="status-badge status-danger" style="font-size: 1rem; padding: 0.5rem 1rem;">ğŸš« Detained</span>
                    {% endif %}
                </div>
            </div>
        </div>

        <div class="card-panel fade-in" style="animation-delay: 0.1s;">
            <div class="panel-header">
                ğŸ“… Attendance History
            </div>
            <table>
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Day</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for d, p in records %}
                    <tr>
                        <td>{{ d }}</td>
                        <td style="color: var(--text-muted);">--</td>
                        <td>
                            {% if p %}
                                <span class="status-badge status-success">Present</span>
                            {% else %}
                                <span class="status-badge status-danger">Absent</span>
                            {% endif %}
                        </td>
                    </tr>
                    {% else %}
                    <tr>
                        <td colspan="3" style="text-align: center; padding: 2rem; color: var(--text-muted);">
                            No attendance records yet.
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}
